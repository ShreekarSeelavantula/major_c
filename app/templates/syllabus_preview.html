{% extends "layout.html" %}

{% block title %}Syllabus Preview | Prep Genie{% endblock %}

{% block content %}

<h2 class="fw-bold mb-2">Syllabus Preview</h2>
<p class="text-muted mb-4">
    Extracted from <strong>{{ filename }}</strong>
</p>

<div class="card shadow-sm mb-4">
    <div class="card-body">

        {% if status == "awaiting_subject_selection" %}

            <h5 class="fw-semibold mb-3">
                Multiple subjects detected
            </h5>

            <p class="text-muted">
                Please select the subject you want to generate a study plan for.
            </p>

            <form method="post" action="/syllabus/select-subject">

                <input type="hidden" name="syllabus_id" value="{{ request.path.split('/')[-1] }}">

                {% for subject in subjects %}
                    <div class="form-check mb-2">
                        <input
                            class="form-check-input"
                            type="radio"
                            name="selected_subject"
                            value="{{ subject }}"
                            required
                        >
                        <label class="form-check-label">
                            {{ subject }}
                        </label>
                    </div>
                {% endfor %}

                <button type="submit" class="btn btn-primary mt-3">
                    Continue →
                </button>

            </form>

        {% else %}

            <h6 class="fw-semibold mb-2">Extracted Text (Preview)</h6>

            <pre style="
                white-space: pre-wrap;
                max-height: 400px;
                overflow-y: auto;
                background: #f8f9fa;
                padding: 15px;
                border-radius: 6px;
            ">{{ analysis or "No analysis available" }}</pre>

            <div class="d-flex justify-content-end mt-4">
                <a href="/plan/configure/{{ request.path.split('/')[-1] }}"
                   class="btn btn-primary">
                    Continue →
                </a>
            </div>

        {% endif %}

    </div>
</div>

<div class="d-flex justify-content-start">
    <a href="/upload" class="btn btn-outline-secondary">
        Re-upload
    </a>
</div>

{% endblock %}
